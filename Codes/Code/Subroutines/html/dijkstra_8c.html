<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Autonomous Robot: dijkstra.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Autonomous Robot</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('dijkstra_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">dijkstra.c File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
</div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstate.html">state</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structjunction.html">junction</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa84a29002ab81c719c0d07bb446296e0"></a><!-- doxytag: member="dijkstra.c::INFINITE" ref="aa84a29002ab81c719c0d07bb446296e0" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>INFINITE</b>&#160;&#160;&#160;1000000</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dijkstra_8c.html#af5250425005ab2eea529c4ac57fcdae3">roadThresh</a>&#160;&#160;&#160;80</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structstate.html">state</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dijkstra_8c.html#aa849497e3ddd7fc3b339a5a65d8e1d7d">botState</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structjunction.html">junction</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dijkstra_8c.html#a753f2f41c6181f91879b56c451d006eb">node</a></td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dijkstra_8c.html#a27e2cc779821c6d574530ff9a527373c">turn</a> { <br/>
&#160;&#160;<b>F</b> =  0, 
<b>L</b> =  1, 
<b>B</b> =  2, 
<b>R</b> =  3, 
<br/>
&#160;&#160;<b>F</b> =  0, 
<b>L</b> =  1, 
<b>B</b> =  2, 
<b>R</b> =  3
<br/>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dijkstra_8c.html#a0df3e9a0a9b05c31d10f4cc8bbdd1856">getNearest</a> (int *dist, int *selected)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dijkstra_8c.html#ab254e0ce2aa89437315f0d67eef85d1f">path</a> (<a class="el" href="structjunction.html">node</a> **graph, int source, int dest)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dijkstra_8c.html#a010ce46a9694b1370a07473a49c6782a">getAnotherAdjNode</a> (int node1, int node2, <a class="el" href="structjunction.html">node</a> **graph)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dijkstra_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dijkstra_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dijkstra_8c.html#a631341956c255e7659119b88e991b43b">pathLength</a> = 0</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><dl class="author"><dt><b>Author:</b></dt><dd>sushil kumar meena (<a href="mailto:sushilm.iitb@gmail.com">sushilm.iitb@gmail.com</a>) </dd>
<dd>
mudit malpani (<a href="mailto:cooldudemd.malpani@gmail.com">cooldudemd.malpani@gmail.com</a>) </dd>
<dd>
palak dalal (<a href="mailto:palak.dalal@gmail.com">palak.dalal@gmail.com</a>) </dd>
<dd>
hemant noval (<a href="mailto:novalhemant@gmail.com">novalhemant@gmail.com</a>)</dd></dl>
<p>Description: This file contains routines that can be used to find the shortest distance path from the source node to the destination node on the road map, using the famous Dijkstra's algorithm. Input files are to be placed in the same folder. It takes terminal input for destination. Can be integrated with graphical interface for taking destination input.</p>
<p>SPECIFICATIONS:</p>
<p>1. All the directions b/w nodes(e,w,n,s) will be based on a reference.</p>
<p>2. Overhead camera must be fixed w.r.t. our map</p>
<p>3. The bot will always maintain a state containing current node &amp; direction(w.r.t. same reference)</p>
<p>4. The bot's turning direction will depend on its state direction. </p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="af5250425005ab2eea529c4ac57fcdae3"></a><!-- doxytag: member="dijkstra.c::roadThresh" ref="af5250425005ab2eea529c4ac57fcdae3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define roadThresh&#160;&#160;&#160;80</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>maximum difference in the x/y coordinate of te nodes on same road </p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="aa849497e3ddd7fc3b339a5a65d8e1d7d"></a><!-- doxytag: member="dijkstra.c::botState" ref="aa849497e3ddd7fc3b339a5a65d8e1d7d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structstate.html">state</a>  <a class="el" href="structstate.html">botState</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>the state of bot i.e. in which direction to turn, lane junctions to be skipped before ant after the turn. </p>

</div>
</div>
<a class="anchor" id="a753f2f41c6181f91879b56c451d006eb"></a><!-- doxytag: member="dijkstra.c::node" ref="a753f2f41c6181f91879b56c451d006eb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structjunction.html">junction</a>  <a class="el" href="structjunction.html">node</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>structure defining length of a road and number of lanes on it </p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a27e2cc779821c6d574530ff9a527373c"></a><!-- doxytag: member="dijkstra.c::turn" ref="a27e2cc779821c6d574530ff9a527373c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="dijkstra_8c.html#a27e2cc779821c6d574530ff9a527373c">turn</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>defines te directions to turn </p>
<div class="fragment"><pre class="fragment">             {
    F = 0, L = 1, B = 2, R = 3
} <a class="code" href="dijkstra_8c.html#a27e2cc779821c6d574530ff9a527373c">turn</a>; <span class="comment">// turnActual = [TurnOrig + (4-direc)]%4;</span>
</pre></div>
</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a010ce46a9694b1370a07473a49c6782a"></a><!-- doxytag: member="dijkstra.c::getAnotherAdjNode" ref="a010ce46a9694b1370a07473a49c6782a" args="(int node1, int node2, node **graph)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getAnotherAdjNode </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>node1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>node2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjunction.html">node</a> **&#160;</td>
          <td class="paramname"><em>graph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>returns a node adjacent to 'node1' except 'node2' </p>
<div class="fragment"><pre class="fragment">                                                    {
        <span class="keywordtype">int</span> i;
        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a>; i++){
                <span class="keywordflow">if</span>(graph[node1][i].dist!=-1 &amp;&amp; i!=node2){
                        <span class="keywordflow">return</span> i;
                }
        }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0df3e9a0a9b05c31d10f4cc8bbdd1856"></a><!-- doxytag: member="dijkstra.c::getNearest" ref="a0df3e9a0a9b05c31d10f4cc8bbdd1856" args="(int *dist, int *selected)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getNearest </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>selected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates the node nearest to the source of all the nodes in 'dist' </p>
<div class="fragment"><pre class="fragment">                                         {
    <span class="keywordtype">int</span> i = 0;
    <span class="keywordtype">int</span> minDist = INFINITE;
    <span class="keywordtype">int</span> minNode;
    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a>; i++) {
        <span class="keywordflow">if</span> (selected[i] != 1) {
            <span class="comment">//printf(&quot;nearNode: %d %d %d %d\n&quot;, i, dist[i], minDist, minNode);</span>
            <span class="keywordflow">if</span> (dist[i] &lt; minDist) {
                minDist = dist[i];
                minNode = i;
            }
        }
    }
    <span class="keywordflow">return</span> minNode;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae66f6b31b5ad750f1fe042a706a4e3d4"></a><!-- doxytag: member="dijkstra.c::main" ref="ae66f6b31b5ad750f1fe042a706a4e3d4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Main File </p>
<div class="fragment"><pre class="fragment">           {
    FILE *nodeFile;<span class="comment">//file containing number of nodes and their x &amp; y coordinates</span>
    nodeFile = fopen(<span class="stringliteral">&quot;nodeAct&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);
    FILE *edgeFile;<span class="comment">//&lt; file containing number of lanes on each road in te form of an adjavcency matrix</span>
    edgeFile = fopen(<span class="stringliteral">&quot;edgesAct&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);

    fscanf(nodeFile, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a>);

    <a class="code" href="structjunction.html">node</a> **graph = malloc(<a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a> * <span class="keyword">sizeof</span> (<a class="code" href="structjunction.html">node</a>*));<span class="comment">//&lt; adjacecny matrix with each edge containg number of lanes</span>

    <span class="keywordtype">int</span>* xCords = malloc(<a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a> * <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));<span class="comment">//&lt; x coordinates of the nodes</span>
    <span class="keywordtype">int</span>* yCords = malloc(<a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a> * <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));<span class="comment">//&lt; y coordinates of the nodes</span>

    <span class="keywordtype">int</span> i;
    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a>; i++) {
        graph[i] = malloc(NUM_NODES * <span class="keyword">sizeof</span> (<a class="code" href="structjunction.html">node</a>));
        <span class="comment">//graph[i][i].dist = -1;</span>
    }

    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a>; i++) {
        fscanf(nodeFile, <span class="stringliteral">&quot;%d&quot;</span>, &amp;xCords[i]);
        fscanf(nodeFile, <span class="stringliteral">&quot;%d&quot;</span>, &amp;yCords[i]);
    }

        <span class="comment">// writing number of lanes and length of roads to the graph</span>
    <span class="keywordtype">int</span> binary;
    <span class="keywordtype">int</span> j, x1, x2, y1, y2, distance;
    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a>; i++) {
        <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a>; j++) {
            fscanf(edgeFile, <span class="stringliteral">&quot;%d&quot;</span>, &amp;binary);
            <span class="keywordflow">if</span> (binary == 0) graph[i][j].dist = -1;
            <span class="keywordflow">else</span> {
                x1 = xCords[i];
                y1 = yCords[i];
                x2 = xCords[j];
                y2 = yCords[j];
                distance = ((y2 - y1)*(y2 - y1) + (x2 - x1)*(x2 - x1));
                graph[i][j].dist = distance;
                graph[i][j].num_lanes = binary;
            }
            printf(<span class="stringliteral">&quot;%d,%d : %d\n&quot;</span>,i,j,binary);
        }
    }

    <span class="keywordtype">int</span> bot_fx,bot_fy,bot_bx,bot_by;

        FILE *botPos = fopen(<span class="stringliteral">&quot;botPos&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);

    fscanf(botPos,<span class="stringliteral">&quot;%d&quot;</span>,&amp;bot_fx);
    fscanf(botPos,<span class="stringliteral">&quot;%d&quot;</span>,&amp;bot_fy);
    fscanf(botPos,<span class="stringliteral">&quot;%d&quot;</span>,&amp;bot_bx);
    fscanf(botPos,<span class="stringliteral">&quot;%d&quot;</span>,&amp;bot_by);

    <span class="keywordtype">int</span> source;

    FILE *startFile;<span class="comment">// source node</span>
    startFile = fopen(<span class="stringliteral">&quot;start&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);

    fscanf(startFile, <span class="stringliteral">&quot;%d&quot;</span>, &amp;source);

    <span class="keywordtype">int</span> dest;<span class="comment">// destination node from user input</span>
        printf(<span class="stringliteral">&quot;Please specify the destination node : &quot;</span>);
        scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;dest);
    <span class="keywordtype">int</span>* actualPath = <a class="code" href="dijkstra_8c.html#ab254e0ce2aa89437315f0d67eef85d1f">path</a>(graph, source, dest);<span class="comment">// path from source to destination</span>


    i = 1;
    <span class="keywordtype">int</span> prevX = bot_fx;
    <span class="keywordtype">int</span> prevY = bot_fy;
    <span class="keywordtype">int</span> currX, currY, nextX, nextY, prevDelX, prevDelY, delX, delY;
    <span class="keywordtype">float</span> slope, prevSlope;
    <a class="code" href="structstate.html">botState</a> *<a class="code" href="dijkstra_8c.html#ab254e0ce2aa89437315f0d67eef85d1f">path</a> = malloc(<a class="code" href="dijkstra_8c.html#a631341956c255e7659119b88e991b43b">pathLength</a>*<span class="keyword">sizeof</span>(<a class="code" href="structstate.html">botState</a>));
    currX = xCords[source];
    currY = yCords[source];
    path[0].direc = F;
    path[0].nodeNum = source;
    path[0].turningLane = 0;
    <span class="keywordflow">while</span> (1) {
        nextX = xCords[actualPath[i]];
        nextY = yCords[actualPath[i]];
        delX = abs(nextX - currX);
        delY = abs(nextY - currY);
        prevDelX = abs(currX - prevX);
        prevDelY = abs(currY - prevY);
       
                <span class="comment">//colculate bot state after each turn</span>
                <span class="keywordtype">int</span> node1 = actualPath[i-1];
                <span class="keywordtype">int</span> node2 = actualPath[i];
                <span class="keywordflow">if</span>((prevDelX &lt; <a class="code" href="dijkstra_8c.html#af5250425005ab2eea529c4ac57fcdae3">roadThresh</a> &amp;&amp; delX &lt; <a class="code" href="dijkstra_8c.html#af5250425005ab2eea529c4ac57fcdae3">roadThresh</a>) || (prevDelY &lt; <a class="code" href="dijkstra_8c.html#af5250425005ab2eea529c4ac57fcdae3">roadThresh</a> &amp;&amp; delY &lt; <a class="code" href="dijkstra_8c.html#af5250425005ab2eea529c4ac57fcdae3">roadThresh</a>)) {
                        path[i].direc = F;
                        <span class="keywordtype">int</span> nodeExtra = <a class="code" href="dijkstra_8c.html#a010ce46a9694b1370a07473a49c6782a">getAnotherAdjNode</a>(node1,node2,graph);
                        path[i].turningLane = graph[node1][nodeExtra].num_lanes;
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(prevDelX &lt; <a class="code" href="dijkstra_8c.html#af5250425005ab2eea529c4ac57fcdae3">roadThresh</a> &amp;&amp; delY &lt; <a class="code" href="dijkstra_8c.html#af5250425005ab2eea529c4ac57fcdae3">roadThresh</a>){
                        <span class="keywordflow">if</span>(prevY &lt; currY){
                                <span class="keywordflow">if</span>(currX &gt; nextX) {
                                        path[i].direc = L;
                                        path[i].turningLane = 1;
                                }
                                <span class="keywordflow">else</span> {
                                        path[i].direc = R;
                                        path[i].turningLane = graph[node1][node2].num_lanes;
                                }
                        }
                        <span class="keywordflow">else</span>{
                                <span class="keywordflow">if</span>(currY &lt; nextY) {
                                        path[i].direc = L;
                                        path[i].turningLane = 1;
                                }
                                <span class="keywordflow">else</span>{
                                        path[i].direc = R;
                                        path[i].turningLane = graph[node1][node2].num_lanes;
                                }
                        }
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(prevDelY &lt; <a class="code" href="dijkstra_8c.html#af5250425005ab2eea529c4ac57fcdae3">roadThresh</a> &amp;&amp; delX &lt; <a class="code" href="dijkstra_8c.html#af5250425005ab2eea529c4ac57fcdae3">roadThresh</a>){
                        <span class="keywordflow">if</span>(prevX &lt; currX){
                                <span class="keywordflow">if</span>(currY &lt; nextY) {
                                        path[i].direc = L;
                                        path[i].turningLane = 1;
                                }
                                <span class="keywordflow">else</span> {
                                        path[i].direc = R;
                                        path[i].turningLane = graph[node1][node2].num_lanes;
                                }
                        }
                        <span class="keywordflow">else</span>{
                                <span class="keywordflow">if</span>(currY &gt; nextY){
                                        path[i].direc = L;
                                        path[i].turningLane = 1;
                                }
                                <span class="keywordflow">else</span> {
                                        path[i].direc = R;
                                        path[i].turningLane = graph[node1][node2].num_lanes;
                                }
                        }
                }

        path[i].nodeNum = actualPath[i];
        <span class="keywordflow">if</span> (actualPath[i] == dest) <span class="keywordflow">break</span>;
        prevX = currX;
        prevY = currY;
        currX = nextX;
        currY = nextY;
        i++;
    }
        
    fclose(startFile);
    FILE *starFile = fopen(<span class="stringliteral">&quot;pathD&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);

        <span class="keywordtype">int</span> as=0;
    printf(<span class="stringliteral">&quot;Path\n&quot;</span>);
    <span class="keywordflow">for</span>(i=0;i&lt;=<a class="code" href="dijkstra_8c.html#a631341956c255e7659119b88e991b43b">pathLength</a>;i++){<span class="comment">// writing path to file</span>
        printf(<span class="stringliteral">&quot;%d(%d,%d)-&gt;\n&quot;</span>,path[i].nodeNum,path[i].direc,path[i].turningLane);
        fprintf(starFile,<span class="stringliteral">&quot;%d\n&quot;</span>,path[i].direc);
        fprintf(starFile,<span class="stringliteral">&quot;%d\n&quot;</span>,path[i].turningLane);
        fprintf(starFile,<span class="stringliteral">&quot;%d\n&quot;</span>,as);
    }
    printf(<span class="stringliteral">&quot;\n&quot;</span>);
        fclose(starFile);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab254e0ce2aa89437315f0d67eef85d1f"></a><!-- doxytag: member="dijkstra.c::path" ref="ab254e0ce2aa89437315f0d67eef85d1f" args="(node **graph, int source, int dest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* path </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structjunction.html">node</a> **&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates shortest path between 'source' and 'dest' using dijkstra and returns te ordered array of the nodes in the path </p>
<div class="fragment"><pre class="fragment">                                              {
    <span class="keywordtype">int</span> *dist = malloc(<a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a> * <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));<span class="comment">// distance of nodes from source</span>
    <span class="keywordtype">int</span> *prev = malloc(<a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a> * <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));<span class="comment">// parent node</span>
    <span class="keywordtype">int</span> *selected = malloc(<a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a> * <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));<span class="comment">// nodes to which shortest path has been found</span>
    <span class="keywordtype">int</span> i = 0;
    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a>; i++) {
        dist[i] = INFINITE;
        prev[i] = -1;
        selected[i] = 0;
    }
    dist[source] = 0;
    <span class="comment">//selected[source]=1;</span>
    <span class="keywordflow">while</span> (selected[dest] != 1) {
        <span class="keywordtype">int</span> curr = <a class="code" href="dijkstra_8c.html#a0df3e9a0a9b05c31d10f4cc8bbdd1856">getNearest</a>(dist, selected);<span class="comment">// get nearest node</span>
        <span class="comment">//printf(&quot;curr:%d\n&quot;, curr);</span>
        <span class="keywordflow">if</span> (dist[curr] == INFINITE) <span class="keywordflow">return</span> NULL;<span class="comment">// no path to destination</span>
        selected[curr] = 1;<span class="comment">// mark the node as selected</span>
        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="combine_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a>; i++) {
            <span class="comment">//printf(&quot;&quot;,i,selected);</span>
            <span class="keywordflow">if</span> (selected[i] != 1 &amp;&amp; graph[curr][i].dist != -1) {
                <span class="keywordtype">int</span> newDist = dist[curr] + graph[curr][i].dist;<span class="comment">// calculate shortest distance from source</span>
                <span class="comment">//printf(&quot;%d,%d,%d &quot;,i,newDist,dist[i]);</span>
                <span class="keywordflow">if</span> (newDist &lt; dist[i]) {
                    <span class="comment">//printf(&quot;updated&quot;);</span>
                    dist[i] = newDist;
                    prev[i] = curr;<span class="comment">// update parent</span>
                }
                printf(<span class="stringliteral">&quot;\n&quot;</span>);
            }
        }
    }
    <span class="keywordtype">int</span> *reversePath = malloc(NUM_NODES * <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));<span class="comment">//path from destination to source</span>
    <span class="keywordtype">int</span> parent = dest;
    <span class="keywordflow">while</span> (parent != source) {
        parent = prev[parent];
        printf(<span class="stringliteral">&quot;%d,&quot;</span>, parent);
        reversePath[<a class="code" href="dijkstra_8c.html#a631341956c255e7659119b88e991b43b">pathLength</a>] = parent;
        <a class="code" href="dijkstra_8c.html#a631341956c255e7659119b88e991b43b">pathLength</a>++;
    }
    printf(<span class="stringliteral">&quot;length: %d\n&quot;</span>, <a class="code" href="dijkstra_8c.html#a631341956c255e7659119b88e991b43b">pathLength</a>);
    <span class="keywordtype">int</span> *actualPath = malloc((NUM_NODES + 1) * <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));<span class="comment">//path from source to destination</span>
    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="dijkstra_8c.html#a631341956c255e7659119b88e991b43b">pathLength</a>; i++) {
        actualPath[i] = reversePath[pathLength - 1 - i];
        printf(<span class="stringliteral">&quot;-&gt;%d&quot;</span>, actualPath[i]);
    }
    actualPath[i] = dest;
    printf(<span class="stringliteral">&quot;-&gt;%d\n&quot;</span>, dest);
    <span class="keywordflow">return</span> actualPath;
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a9bb6aa82571eb861fc56723217d23b17"></a><!-- doxytag: member="dijkstra.c::NUM_NODES" ref="a9bb6aa82571eb861fc56723217d23b17" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="dijkstra_8c.html#a9bb6aa82571eb861fc56723217d23b17">NUM_NODES</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>number of road junctions </p>

</div>
</div>
<a class="anchor" id="a631341956c255e7659119b88e991b43b"></a><!-- doxytag: member="dijkstra.c::pathLength" ref="a631341956c255e7659119b88e991b43b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="dijkstra_8c.html#a631341956c255e7659119b88e991b43b">pathLength</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>number of nodes in the path calculated </p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dijkstra_8c.html">dijkstra.c</a>      </li>
      <li class="footer">Generated on Wed Apr 13 2011 11:30:38 for Autonomous Robot by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
